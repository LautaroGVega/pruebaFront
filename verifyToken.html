<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Verificación de Código QR</title>
</head>
<body>
  <h1>Verificación de Código QR</h1>
  
  <p id="verificationMessage">Verificando...</p>

  <script>
    async function verifyToken() {
      // Obtiene los parámetros de la URL (token, numeroevento y numeroescultor)
      const urlParams = new URLSearchParams(window.location.pathname.split('/').slice(1).join('/'));

      const token = urlParams.get('token');
      const numeroevento = urlParams.get('numeroevento');
      const numeroescultor = urlParams.get('numeroescultor');

      // Verifica que los parámetros existan
      if (!token || !numeroevento || !numeroescultor) {
        document.getElementById("verificationMessage").textContent = "Datos de verificación no encontrados en la URL.";
        return;
      }

      try {
        // Realiza la solicitud de verificación al backend
        const response = await fetch(`http://localhost:3000/${token}/${numeroevento}/${numeroescultor}`);
        
        if (response.ok) {
          const data = await response.json();
          document.getElementById("verificationMessage").textContent = data.message;
        } else {
          document.getElementById("verificationMessage").textContent = "Código QR inválido o expirado.";
        }
      } catch (error) {
        console.error(error);
        document.getElementById("verificationMessage").textContent = "Error al verificar el código QR.";
      }
    }

    // Llama a la función de verificación cuando se carga la página
    verifyToken();
  </script>
</body>
</html>
